<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Stemrunner</title>
  <style>
  body { font-family: sans-serif; margin: 2em; }
  #dropzone { border: 2px dashed #999; padding: 2em; text-align: center; }
  progress { width: 100%; }
  </style>
</head>
<body>
  <h1>Stemrunner</h1>
  <div id="dropzone">Drop files here or click to upload</div>
  <input type="file" id="fileInput" multiple style="display:none" />
  <div id="status"></div>
<script>
const dropzone = document.getElementById('dropzone');
const fileInput = document.getElementById('fileInput');
const status = document.getElementById('status');

function upload(file) {
  const formData = new FormData();
  formData.append('file', file);
  fetch('/upload', {method: 'POST', body: formData})
    .then(r => r.json())
    .then(data => {
      const div = document.createElement('div');
      div.textContent = `Queued ${file.name}: ${data.stems.join(', ')}`;
      status.appendChild(div);
    });
}

dropzone.addEventListener('click', () => fileInput.click());
fileInput.addEventListener('change', () => {
  [...fileInput.files].forEach(upload);
});

dropzone.addEventListener('dragover', e => {
  e.preventDefault();
  dropzone.style.background = '#eee';
});
dropzone.addEventListener('dragleave', () => dropzone.style.background = '');
dropzone.addEventListener('drop', e => {
  e.preventDefault();
  dropzone.style.background = '';
  [...e.dataTransfer.files].forEach(upload);
});
</script>
</body>
</html>
